---
title: Counting Primes Functionally
author: Markus Shepherd
type: post
date: 2014-01-12T11:31:23+00:00
url: /2014/01/counting-primes-functionally/
categories:
  - "Riemann's Paper"
tags:
  - Chebyshev
  - Möbius inversion

---
After all this playing with the <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_3c22ba7aade15ea2b2852cd51bb4d6d4.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>-function it is time to return to the overall objective of this whole exercise: counting prime numbers. The idea behind analytic number theory is that primes are unpredictable on the small scale, but actually surprising regular on the large scale. This is why we'll look at certain functions that behave pretty erratically when we look at every single value, but become smooth and "easy" to calculate once we "zoom out" and consider the global properties, the so-called asymptotic.<!--more-->

I've mentioned the function <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_e5cb16c20d9f01bbbfe8f299e28d1f4b.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> before which is defined as the number of primes not exceeding some real <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_9dd4e461268c8034f5c8564e155c67a6.gif' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" /></span>. (Never mind the overloading of the symbol <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_4f08e3dba63dc6d40b22952c7a9dac6d.gif' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" /></span> for different and completely unrelated functions, constants, etc. It's been like that for ever, and always will be. Mathematicians are pretty stubborn.) If we can calculate <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_e5cb16c20d9f01bbbfe8f299e28d1f4b.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> exactly, we would have perfect information about the primes since the function counts the primes exactly. Theoretically. But as mentioned before, we are only interested in capturing the overall behaviour, forgetting "local" irregularities.

So, what does <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_e5cb16c20d9f01bbbfe8f299e28d1f4b.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> look like? Most of the time, it is just a flat line for most of the values when the count does not change as they are not primes. At every prime value it jumps up by one step. That's it.

[<img class="aligncenter wp-image-181 size-medium" src="http://localhost:8885/riemannhypothesis.info/wp-content/uploads/2014/01/500px-PrimePi.svg_-300x193.png" alt="Prime Counting Function" width="300" height="193" srcset="http://localhost:8885/riemannhypothesis.info/wp-content/uploads/2014/01/500px-PrimePi.svg_-300x193.png 300w, http://localhost:8885/riemannhypothesis.info/wp-content/uploads/2014/01/500px-PrimePi.svg_.png 500w" sizes="(max-width: 300px) 100vw, 300px" />][1]

Well, almost. It turns out that it's convenient to define the value of <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_e5cb16c20d9f01bbbfe8f299e28d1f4b.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> for primes as "half the step", i.e., the value of <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_ace1aa27ed8c0f888df833acabcbc8ab.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> would be <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_c81e728d9d4c2f636f067f89cc14862c.gif' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" /></span>, <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_7eb0a8da506a1f3999dce8751b1247f9.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> is <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_8221435bcce913b5c2dc22eaf6cb6590.gif' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" /></span>, and <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_1d7ef5224ce72b2ca005c1be06b1e33f.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> then takes the value <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_eccbc87e4b5ce2fe28308fd9f2a7baf3.gif' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" /></span>. It doesn't matter asymptotically, but the arguments that follow will go more smoothly. Yet, this is quite inconvenient to write out every time, so I will drop it for most of time, but always implicitly assume that functions at values where the argument jumps are "smoothed out".

It is usually interesting to look at the density of a certain sequence, i.e., the proportion of all integers that are members of that sequence. In this case it means calculating <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_10a4aa2b69565a7dd91d5f5da49153bf.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>. But already quite elementary arguments are sufficient to show that this value tends to zero. In other word, the density of the primes is zero. Now, in order to obtain a function that behaves more like <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_9dd4e461268c8034f5c8564e155c67a6.gif' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" /></span> we need to give the primes a sufficient weight. It is the nature of the Prime Number Theorem that the <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_7b8b965ad4bca0e41ab51de7b31363a1.gif' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" /></span>th prime is about <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_1071e6027d8b0ca8051265f29565947f.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>. This means that we need to give each prime weight <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_0d2e858bd7f89eed5461e5637d6e0a50.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> to obtain a function that behaves like <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_9dd4e461268c8034f5c8564e155c67a6.gif' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" /></span>. This function was first introduced by Pafnuty Chebyshev, is usually called <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_00a3e681e7f16483324136c5f343c197.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>, and formally defined as <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_8c4ec5ccc0e6d0b62634f3b1a61442de.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>, where the sum runs over all primes not exceeding <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_9dd4e461268c8034f5c8564e155c67a6.gif' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" /></span>. Just for the sake of completeness, I will mention the closely related function <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_e5a23578cdb4d60badd4ca7cea6cdc55.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> that gives weight <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_13f89954f5de407793e2443ab28a541a.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> not only to primes, but also to prime powers <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_9d0408f6baa8986c76a4899544d28251.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>.

Both functions <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_00a3e681e7f16483324136c5f343c197.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> and <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_e5a23578cdb4d60badd4ca7cea6cdc55.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> may seem a little artificial at first glance, but they are in fact very natural in the context of counting primes. It is probably best depicted by the fact that the Prime Number Theorem <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_9e009b4db95327cc36b10922ca4fc3f1.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> is equivalent to <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_da2589353fb1371383c00e1457b1af4e.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> and <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_42441d2dbeaabee04dd3c1b8d17fbcaa.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>.  This relates to my earlier comment that we assign a certain weight to the primes in order to obtain a function with a positive density. Many equations including prime counting functions become more concise by writing them in terms of <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_00a3e681e7f16483324136c5f343c197.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> instead of <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_e5cb16c20d9f01bbbfe8f299e28d1f4b.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>.

To confuse things even further, we will need yet another prime counting function for our purposes. It is usually denoted <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_0e1bdd682c4fb6a43493d0eb21d9bf0d.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> and counts all the primes below <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_9dd4e461268c8034f5c8564e155c67a6.gif' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" /></span> plus _half_ the prime squares plus a _third_ of the prime cubes etc. How many numbers below <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_9dd4e461268c8034f5c8564e155c67a6.gif' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" /></span> are the perfect square of a prime? It may sound tricky to count these, but it's quite easy if we approach the problem from the other direction: How do we generate all prime squares not exceeding <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_9dd4e461268c8034f5c8564e155c67a6.gif' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" /></span>? Well, we go through all the primes and take their square. We stop as soon as <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_ca77baa174984994b648741752abfe84.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> exceeds <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_9dd4e461268c8034f5c8564e155c67a6.gif' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" /></span>. In other words, we can generate a prime square for every prime below <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_1a03d0f7242823c05e0f16ad19f85201.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>. And here's our answer! There are <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_7a222b017a28ca4a04ee79f5bbffe9e8.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> prime squares not exceeding <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_9dd4e461268c8034f5c8564e155c67a6.gif' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" /></span>. The same argument goes for cubes and higher powers. This gives us a neat formula for <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_0e1bdd682c4fb6a43493d0eb21d9bf0d.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>:

<p style='text-align:center;'>
  <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_0c5f57a4c77ffe7e335f3d49ec57e825.gif' style='vertical-align: middle; border: none;' class='tex' alt="" /></span>
</p>

It is worth noting that this is actually a finite series. No matter how large you choose <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_9dd4e461268c8034f5c8564e155c67a6.gif' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" /></span>, the value <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_221e883a0f7f6f1fb3a57690de684c90.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> will get smaller as the <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_7b8b965ad4bca0e41ab51de7b31363a1.gif' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" /></span> in the series increases, and will eventually drop below <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_c81e728d9d4c2f636f067f89cc14862c.gif' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" /></span>. Since there are no primes smaller than <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_c81e728d9d4c2f636f067f89cc14862c.gif' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" /></span>, the value of <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_dad213d72a47af600be59e3f337718e9.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> for that <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_7b8b965ad4bca0e41ab51de7b31363a1.gif' style='vertical-align: middle; border: none; padding-bottom:2px;' class='tex' alt="" /></span> and all subsequent ones will be zero, effectively terminating the sum.

There's another way of expressing <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_0e1bdd682c4fb6a43493d0eb21d9bf0d.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>. The same way that <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_e5cb16c20d9f01bbbfe8f299e28d1f4b.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> can be expressed as a straightforward "counting sum"

<p style='text-align:center;'>
  <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_fdc2cba8a26e783053ff7aca1a90c652.gif' style='vertical-align: middle; border: none;' class='tex' alt="" /></span>
</p>

which literally just means "count <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_c4ca4238a0b923820dcc509a6f75849b.gif' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" /></span> for each prime", we can write down the same for <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_0e1bdd682c4fb6a43493d0eb21d9bf0d.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>. How exactly do we count here? Well, for any prime <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_83878c91171338902e0fe0fb97a8c47a.gif' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" /></span>, we count <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_c4ca4238a0b923820dcc509a6f75849b.gif' style='vertical-align: middle; border: none; padding-bottom:1px;' class='tex' alt="" /></span> for the prime, <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_975ca8804565c1a569450d61090b2743.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> for the square <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_ca77baa174984994b648741752abfe84.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>, <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_ba0965330d709297a9d8b07f305169cd.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> for the cube <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_8dd8ba1c4dcbad0b4ef12b710183031b.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>, etc. Then we just add up everything:

<p style='text-align:center;'>
  <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_f0242a45f83dae782e881889db4df48a.gif' style='vertical-align: middle; border: none;' class='tex' alt="" /></span>
</p>

The cool thing is that we can get the value of <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_e5cb16c20d9f01bbbfe8f299e28d1f4b.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> back from <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_0e1bdd682c4fb6a43493d0eb21d9bf0d.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> through a technique called _Möbius inversion_. It is actually not too difficult but slightly out of scope here, so let's be content for now that we can invert certain sums by means of the so-called Möbius function <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_dd212270229767191a8e42b95f2e9c33.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>. This and similar inversion techniques would deserve an article on their own right, but for now without further ado, this is the inverted formula:

<p style='text-align:center;'>
  <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_237fd63d0c0557f24d3153c707ca816d.gif' style='vertical-align: middle; border: none;' class='tex' alt="" /></span>
</p>

You may think: Big whoop! We wrote down a much more complicated function, just to find another complicated expression to get our initial object of study back, but haven't learnt anything new. The great news is that we can calculate <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_0e1bdd682c4fb6a43493d0eb21d9bf0d.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span> to any precision we care with the aid of the <span class='MathJax_Preview'><img src='http://localhost:8885/riemannhypothesis.info/wp-content/plugins/latex/cache/tex_3c22ba7aade15ea2b2852cd51bb4d6d4.gif' style='vertical-align: middle; border: none; ' class='tex' alt="" /></span>-function and its zeros.

But that's the subject of the next article. (Am I getting better at my cliffhangers?)

 [1]: http://localhost:8885/wp-content/uploads/2014/01/500px-PrimePi.svg_.png